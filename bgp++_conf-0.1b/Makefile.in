SHELL = /bin/sh
VERS= 0.1b
VPATH = @srcdir@
top_srcdir = @top_srcdir@
ex_dir = $(top_srcdir)/ex
doc_dir = $(top_srcdir)/doc

CPP = @CXX@
CPPFLAGS = @CPPFLAGS@
LDFLAGS = @LDFLAGS@
LIBS = @LIBS@
SOURCES = bgp++_conf.cc stringtok.h
EX = $(ex_dir)/additional.info $(ex_dir)/EXAMPLE  $(ex_dir)/ns.tcl \
	$(ex_dir)/router.info  $(ex_dir)/routerprefs.info
CONFS = $(ex_dir)/conf/bgpd1.conf $(ex_dir)/conf/bgpd1e2.conf $(ex_dir)/conf/bgpd1e.conf $(ex_dir)/conf/bgpd2.conf \
	$(ex_dir)/conf/bgpd2e2.conf $(ex_dir)/conf/bgpd3e2.conf $(ex_dir)/conf/bgpd5.conf \
	$(ex_dir)/conf/bgpd7018.conf $(ex_dir)/conf/bgpd8.conf $(ex_dir)/conf/bgpd13609.conf \
	$(ex_dir)/conf/bgpd1e1.conf $(ex_dir)/conf/bgpd1e3.conf $(ex_dir)/conf/bgpd25710.conf \
	$(ex_dir)/conf/bgpd2e1.conf $(ex_dir)/conf/bgpd3e1.conf $(ex_dir)/conf/bgpd4.conf \
	$(ex_dir)/conf/bgpd6.conf $(ex_dir)/conf/bgpd7.conf 
MISC=configure Makefile.in config.h.in README

# Rule for making .o from .cc
%.o:	%.cc
	@echo Compiling $*	
	rm -f $*.o
	$(CPP) $(CPPFLAGS) -g -c $*.cc

bgp++_conf:	bgp++_conf.o
	$(CPP) -g -o bgp++_conf bgp++_conf.o
clean:	
	rm -f *.o
# a rule to make snapshots
snapshot: $(SOURCES) $(EX) $(MISC)
	@echo
	@echo "->Making snapshot version $(VERS)"
	@echo
	@echo "->copying all release files to the directory " bgp++_conf-$(VERS)
	@echo
	mkdir bgp++_conf-$(VERS)
	mkdir bgp++_conf-$(VERS)/ex
	mkdir bgp++_conf-$(VERS)/ex/conf
	mkdir bgp++_conf-$(VERS)/doc
	makeinfo $(doc_dir)/bgp++_conf.texinfo
	mv bgp++_conf.info bgp++_conf-$(VERS)/doc
	cp $(SOURCES) $(MISC) bgp++_conf-$(VERS)
	cp $(EX) bgp++_conf-$(VERS)/ex
	cp $(CONFS) bgp++_conf-$(VERS)/ex/conf
	@echo
	@echo "->making the compressed tar file " bgp++_conf-$(VERS).tar.gz
	@echo
	tar czf bgp++_conf-$(VERS).tar.gz bgp++_conf-$(VERS)/
	@echo
	@echo "->removing the temporary directory " bgp++_conf-$(VERS)
	/bin/rm -rf bgp++_conf-$(VERS)             # remove the old directory
