! router 5646

!Debug options
!debug bgp 
!debug bgp fsm
debug bgp keepalives
!debug bgp filters
!debug bgp events
debug bgp updates


log file bgpd5646.log

router bgp 5646
bgp router-id 22.14.0.1

!Neighbor List

!neighbor 1
neighbor 0.1.0.1	remote-as 1
!peer
neighbor 0.1.0.1	route-map RMAP_PEER_IN in
neighbor 0.1.0.1	route-map RMAP_NONCUST_OUT out


!neighbor 174
neighbor 0.174.0.1	remote-as 174
!peer
neighbor 0.174.0.1	route-map RMAP_PEER_IN in
neighbor 0.174.0.1	route-map RMAP_NONCUST_OUT out


!neighbor 293
neighbor 1.37.0.1	remote-as 293
!peer
neighbor 1.37.0.1	route-map RMAP_PEER_IN in
neighbor 1.37.0.1	route-map RMAP_NONCUST_OUT out


!neighbor 297
neighbor 1.41.0.1	remote-as 297
!peer
neighbor 1.41.0.1	route-map RMAP_PEER_IN in
neighbor 1.41.0.1	route-map RMAP_NONCUST_OUT out


!neighbor 701
neighbor 2.189.0.1	remote-as 701
!peer
neighbor 2.189.0.1	route-map RMAP_PEER_IN in
neighbor 2.189.0.1	route-map RMAP_NONCUST_OUT out


!neighbor 1239
neighbor 4.215.0.1	remote-as 1239
!provider (full routes)
neighbor 4.215.0.1	route-map RMAP_PROV_IN in
neighbor 4.215.0.1	route-map RMAP_NONCUST_OUT out


!neighbor 1323
neighbor 5.43.0.1	remote-as 1323
!peer
neighbor 5.43.0.1	route-map RMAP_PEER_IN in
neighbor 5.43.0.1	route-map RMAP_NONCUST_OUT out


!neighbor 1740
neighbor 6.204.0.1	remote-as 1740
!peer
neighbor 6.204.0.1	route-map RMAP_PEER_IN in
neighbor 6.204.0.1	route-map RMAP_NONCUST_OUT out


!neighbor 2914
neighbor 11.98.0.1	remote-as 2914
!peer
neighbor 11.98.0.1	route-map RMAP_PEER_IN in
neighbor 11.98.0.1	route-map RMAP_NONCUST_OUT out


!neighbor 3561
neighbor 13.233.0.1	remote-as 3561
!peer
neighbor 13.233.0.1	route-map RMAP_PEER_IN in
neighbor 13.233.0.1	route-map RMAP_NONCUST_OUT out


!neighbor 3847
neighbor 15.7.0.1	remote-as 3847
!peer
neighbor 15.7.0.1	route-map RMAP_PEER_IN in
neighbor 15.7.0.1	route-map RMAP_NONCUST_OUT out


!neighbor 5413
neighbor 21.37.0.1	remote-as 5413
!peer
neighbor 21.37.0.1	route-map RMAP_PEER_IN in
neighbor 21.37.0.1	route-map RMAP_NONCUST_OUT out


!neighbor 38
neighbor 0.38.0.1	remote-as 38
!customer (full routes)
neighbor 0.38.0.1	route-map RMAP_CUSTFULL_IN in
neighbor 0.38.0.1	route-map RMAP_CUSTFULL_OUT out

!neighbor 103
neighbor 0.103.0.1	remote-as 103
!customer (full routes)
neighbor 0.103.0.1	route-map RMAP_CUSTFULL_IN in
neighbor 0.103.0.1	route-map RMAP_CUSTFULL_OUT out

!neighbor 160
neighbor 0.160.0.1	remote-as 160
!customer (full routes)
neighbor 0.160.0.1	route-map RMAP_CUSTFULL_IN in
neighbor 0.160.0.1	route-map RMAP_CUSTFULL_OUT out

!neighbor 693
neighbor 2.181.0.1	remote-as 693
!customer (full routes)
neighbor 2.181.0.1	route-map RMAP_CUSTFULL_IN in
neighbor 2.181.0.1	route-map RMAP_CUSTFULL_OUT out

!neighbor 1746
neighbor 6.210.0.1	remote-as 1746
!customer (full routes)
neighbor 6.210.0.1	route-map RMAP_CUSTFULL_IN in
neighbor 6.210.0.1	route-map RMAP_CUSTFULL_OUT out

!neighbor 2381
neighbor 9.77.0.1	remote-as 2381
!customer (full routes)
neighbor 9.77.0.1	route-map RMAP_CUSTFULL_IN in
neighbor 9.77.0.1	route-map RMAP_CUSTFULL_OUT out

!neighbor 2907
neighbor 11.91.0.1	remote-as 2907
!customer (full routes)
neighbor 11.91.0.1	route-map RMAP_CUSTFULL_IN in
neighbor 11.91.0.1	route-map RMAP_CUSTFULL_OUT out

!neighbor 3365
neighbor 13.37.0.1	remote-as 3365
!customer (full routes)
neighbor 13.37.0.1	route-map RMAP_CUSTFULL_IN in
neighbor 13.37.0.1	route-map RMAP_CUSTFULL_OUT out

!neighbor 3393
neighbor 13.65.0.1	remote-as 3393
!customer (full routes)
neighbor 13.65.0.1	route-map RMAP_CUSTFULL_IN in
neighbor 13.65.0.1	route-map RMAP_CUSTFULL_OUT out

!neighbor 3669
neighbor 14.85.0.1	remote-as 3669
!customer (full routes)
neighbor 14.85.0.1	route-map RMAP_CUSTFULL_IN in
neighbor 14.85.0.1	route-map RMAP_CUSTFULL_OUT out

!neighbor 3789
neighbor 14.205.0.1	remote-as 3789
!customer (full routes)
neighbor 14.205.0.1	route-map RMAP_CUSTFULL_IN in
neighbor 14.205.0.1	route-map RMAP_CUSTFULL_OUT out

!neighbor 4247
neighbor 16.151.0.1	remote-as 4247
!customer (full routes)
neighbor 16.151.0.1	route-map RMAP_CUSTFULL_IN in
neighbor 16.151.0.1	route-map RMAP_CUSTFULL_OUT out

!neighbor 4358
neighbor 17.6.0.1	remote-as 4358
!customer (full routes)
neighbor 17.6.0.1	route-map RMAP_CUSTFULL_IN in
neighbor 17.6.0.1	route-map RMAP_CUSTFULL_OUT out

!neighbor 4527
neighbor 17.175.0.1	remote-as 4527
!customer (full routes)
neighbor 17.175.0.1	route-map RMAP_CUSTFULL_IN in
neighbor 17.175.0.1	route-map RMAP_CUSTFULL_OUT out

!neighbor 5700
neighbor 22.68.0.1	remote-as 5700
!customer (full routes)
neighbor 22.68.0.1	route-map RMAP_CUSTFULL_IN in
neighbor 22.68.0.1	route-map RMAP_CUSTFULL_OUT out

!neighbor 6136
neighbor 23.248.0.1	remote-as 6136
!customer (full routes)
neighbor 23.248.0.1	route-map RMAP_CUSTFULL_IN in
neighbor 23.248.0.1	route-map RMAP_CUSTFULL_OUT out

!neighbor 6200
neighbor 24.56.0.1	remote-as 6200
!customer (full routes)
neighbor 24.56.0.1	route-map RMAP_CUSTFULL_IN in
neighbor 24.56.0.1	route-map RMAP_CUSTFULL_OUT out

!neighbor 6214
neighbor 24.70.0.1	remote-as 6214
!customer (full routes)
neighbor 24.70.0.1	route-map RMAP_CUSTFULL_IN in
neighbor 24.70.0.1	route-map RMAP_CUSTFULL_OUT out

!neighbor 6217
neighbor 24.73.0.1	remote-as 6217
!customer (full routes)
neighbor 24.73.0.1	route-map RMAP_CUSTFULL_IN in
neighbor 24.73.0.1	route-map RMAP_CUSTFULL_OUT out

!neighbor 6259
neighbor 24.115.0.1	remote-as 6259
!customer (full routes)
neighbor 24.115.0.1	route-map RMAP_CUSTFULL_IN in
neighbor 24.115.0.1	route-map RMAP_CUSTFULL_OUT out

!neighbor 6349
neighbor 24.205.0.1	remote-as 6349
!customer (full routes)
neighbor 24.205.0.1	route-map RMAP_CUSTFULL_IN in
neighbor 24.205.0.1	route-map RMAP_CUSTFULL_OUT out

!neighbor 6365
neighbor 24.221.0.1	remote-as 6365
!customer (full routes)
neighbor 24.221.0.1	route-map RMAP_CUSTFULL_IN in
neighbor 24.221.0.1	route-map RMAP_CUSTFULL_OUT out

!neighbor 6379
neighbor 24.235.0.1	remote-as 6379
!customer (full routes)
neighbor 24.235.0.1	route-map RMAP_CUSTFULL_IN in
neighbor 24.235.0.1	route-map RMAP_CUSTFULL_OUT out

!neighbor 6392
neighbor 24.248.0.1	remote-as 6392
!customer (full routes)
neighbor 24.248.0.1	route-map RMAP_CUSTFULL_IN in
neighbor 24.248.0.1	route-map RMAP_CUSTFULL_OUT out

!neighbor 6402
neighbor 25.2.0.1	remote-as 6402
!customer (full routes)
neighbor 25.2.0.1	route-map RMAP_CUSTFULL_IN in
neighbor 25.2.0.1	route-map RMAP_CUSTFULL_OUT out

!neighbor 6496
neighbor 25.96.0.1	remote-as 6496
!customer (full routes)
neighbor 25.96.0.1	route-map RMAP_CUSTFULL_IN in
neighbor 25.96.0.1	route-map RMAP_CUSTFULL_OUT out

!neighbor 6555
neighbor 25.155.0.1	remote-as 6555
!customer (full routes)
neighbor 25.155.0.1	route-map RMAP_CUSTFULL_IN in
neighbor 25.155.0.1	route-map RMAP_CUSTFULL_OUT out

!neighbor 6576
neighbor 25.176.0.1	remote-as 6576
!customer (full routes)
neighbor 25.176.0.1	route-map RMAP_CUSTFULL_IN in
neighbor 25.176.0.1	route-map RMAP_CUSTFULL_OUT out

!neighbor 6716
neighbor 26.60.0.1	remote-as 6716
!customer (full routes)
neighbor 26.60.0.1	route-map RMAP_CUSTFULL_IN in
neighbor 26.60.0.1	route-map RMAP_CUSTFULL_OUT out

!neighbor 7062
neighbor 27.150.0.1	remote-as 7062
!customer (full routes)
neighbor 27.150.0.1	route-map RMAP_CUSTFULL_IN in
neighbor 27.150.0.1	route-map RMAP_CUSTFULL_OUT out

!neighbor 7189
neighbor 28.21.0.1	remote-as 7189
!customer (full routes)
neighbor 28.21.0.1	route-map RMAP_CUSTFULL_IN in
neighbor 28.21.0.1	route-map RMAP_CUSTFULL_OUT out

!neighbor 7263
neighbor 28.95.0.1	remote-as 7263
!customer (full routes)
neighbor 28.95.0.1	route-map RMAP_CUSTFULL_IN in
neighbor 28.95.0.1	route-map RMAP_CUSTFULL_OUT out

!neighbor 7395
neighbor 28.227.0.1	remote-as 7395
!customer (full routes)
neighbor 28.227.0.1	route-map RMAP_CUSTFULL_IN in
neighbor 28.227.0.1	route-map RMAP_CUSTFULL_OUT out

!neighbor 7752
neighbor 30.72.0.1	remote-as 7752
!customer (full routes)
neighbor 30.72.0.1	route-map RMAP_CUSTFULL_IN in
neighbor 30.72.0.1	route-map RMAP_CUSTFULL_OUT out

!neighbor 7820
neighbor 30.140.0.1	remote-as 7820
!customer (full routes)
neighbor 30.140.0.1	route-map RMAP_CUSTFULL_IN in
neighbor 30.140.0.1	route-map RMAP_CUSTFULL_OUT out

!neighbor 10268
neighbor 40.28.0.1	remote-as 10268
!customer (full routes)
neighbor 40.28.0.1	route-map RMAP_CUSTFULL_IN in
neighbor 40.28.0.1	route-map RMAP_CUSTFULL_OUT out

!neighbor 10377
neighbor 40.137.0.1	remote-as 10377
!customer (full routes)
neighbor 40.137.0.1	route-map RMAP_CUSTFULL_IN in
neighbor 40.137.0.1	route-map RMAP_CUSTFULL_OUT out

!neighbor 10692
neighbor 41.196.0.1	remote-as 10692
!customer (full routes)
neighbor 41.196.0.1	route-map RMAP_CUSTFULL_IN in
neighbor 41.196.0.1	route-map RMAP_CUSTFULL_OUT out

!neighbor 10711
neighbor 41.215.0.1	remote-as 10711
!customer (full routes)
neighbor 41.215.0.1	route-map RMAP_CUSTFULL_IN in
neighbor 41.215.0.1	route-map RMAP_CUSTFULL_OUT out

!neighbor 10839
neighbor 42.87.0.1	remote-as 10839
!customer (full routes)
neighbor 42.87.0.1	route-map RMAP_CUSTFULL_IN in
neighbor 42.87.0.1	route-map RMAP_CUSTFULL_OUT out


!Policy
!
!community values:  
!  customer    : 100:30
!  non-customer: 100:20

!localpref values:  
!  customer: 30
!  peer    : 20
!  provider: 10

!Route attributes for locally originated prefixes
!community values: 200:<numeric-attr>

route-map RMAP_PROV_IN permit 10
  set community-additive 100:20
  set local-preference 10
route-map RMAP_PEER_IN permit 10
  set community-additive 100:20
  set local-preference 20
route-map RMAP_NONCUST_OUT deny 10
  match community NONCUST
route-map RMAP_NONCUST_OUT permit 20
  match community CUST
  set community-delete CUST
! should never reach this actually
route-map RMAP_NONCUST_OUT permit 30

route-map RMAP_CUSTFULL_IN permit 10
  set community-additive 100:30
  set local-preference 30

route-map RMAP_CUSTFULL_OUT permit 10
  set community-delete NONLOCAL

ip community-list CUST permit 100:30
ip community-list NONCUST permit 100:20
ip community-list NONLOCAL permit 100:20
ip community-list NONLOCAL permit 100:30

